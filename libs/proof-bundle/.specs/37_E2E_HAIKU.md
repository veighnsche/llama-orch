# Proof-Bundle — E2E Haiku (37_E2E_HAIKU)

Status: Draft
Owner: @llama-orch-maintainers
Date: 2025-09-26

## Scope
E2E Haiku validates live GPU token streaming via the orchestrator. This suite does not live in `libs/proof-bundle`, but the harness consumes this crate to write artifacts. This document clarifies how the crate is expected to be used by the E2E harness.

## Expectations When Used by E2E Haiku Harness
- Use `ProofBundle::for_type(TestType::E2eHaiku)` to open `e2e-haiku/<run_id>/`.
- Emit required artifacts:
  - `gpu_env.json` — device model, driver, CUDA/CuDNN, memory
  - `sse_transcript.ndjson` — `{ event: "started|token|metrics|end", ... }`
  - `metrics_snapshot.json` — throughput/latency summaries
  - `run_log_redacted.md` — redacted run log
  - `test_report.md` — summary and constraints satisfied
- Enforce headers per PB-1012 automatically:
  - NDJSON: first metadata record (use `append_ndjson_autogen_meta`)
  - Markdown: start with `# AUTOGENERATED: Proof Bundle` (use `write_markdown_with_header`)
  - JSON: include sibling `.meta` (use `write_json_with_meta`)
- Respect envs:
  - `REQUIRE_REAL_LLAMA=1` — harness assertion
  - `LLORCH_PROOF_DIR` — override base directory
  - `LLORCH_RUN_ID` — group artifacts per run

## Non-Goals
- No Haiku tests are authored inside this crate.

## Links
- Central type guide: `/.docs/testing/types/e2e-haiku.md`
- Template: `/.proof_bundle/templates/e2e-haiku/README.md`
- Spec: `/.specs/00_proof-bundle.md` (PB-1012)
- Contracts: `/.specs/10_contracts.md`
