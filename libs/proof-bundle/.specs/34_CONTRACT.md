# Proof-Bundle — Contract Tests (34_CONTRACT)

Status: Draft
Owner: @llama-orch-maintainers
Date: 2025-09-26

## Purpose
Treat the `proof-bundle` public API and on-disk semantics as a contract for all consumers in the workspace. These tests verify normative behavior that other crates rely on.

## Contract Surface (see `/.specs/10_contracts.md`)
- API: `ProofBundle::for_type`, `root`, `ensure_dir`, `append_ndjson`, `write_json`, `write_markdown`, `seeds().record`
- Helpers: `write_markdown_with_header`, `append_ndjson_autogen_meta`, `write_meta_sibling`, `write_json_with_meta`
- Env: `LLORCH_PROOF_DIR`, `LLORCH_RUN_ID`
- Mapping: `TestType` → directory names
- Headers: Autogenerated header/metadata

## Required Behaviors
- Stable directory layout and mapping (PB-1001, PB-1010)
- Env overrides (PB-1003)
- Format rules (PB-1004)
- Header/metadata enforcement (PB-1012)
- Error model (PB-1008) — `anyhow::Result` and no panics in normal flows

## Representative Tests (live under `tests/conformance.rs`)
- PBV-2001..PBV-2009

## Commands
- `cargo test -p proof-bundle --test conformance -- --nocapture`

## Out of Scope
- Network/API contracts (not applicable).
- SSE/HTTP behavior (covered by orchestrator-level suites).

## Links
- Spec: `/.specs/00_proof-bundle.md`
- Crate contracts: `/.specs/10_contracts.md`
- Central testing types: `/.docs/testing/TEST_TYPES_GUIDE.md`
