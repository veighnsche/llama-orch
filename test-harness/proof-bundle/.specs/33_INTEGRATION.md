# Proof-Bundle â€” Integration Tests (33_INTEGRATION)

Status: Draft
Owner: @llama-orch-maintainers
Date: 2025-09-26

## Scope
End-to-end behaviors using the public API against a temporary filesystem root. Verifies path resolution, environment overrides, header enforcement, and artifact formats.

## What to Test
- Base/Run directory creation (PB-1001, PB-1002, PB-1003)
  - `ProofBundle::for_type(TestType)` creates `<base>/<type>/<run_id>/`
  - Honors `LLORCH_PROOF_DIR` and `LLORCH_RUN_ID`
- Writers & headers (PB-1004, PB-1005, PB-1006, PB-1012)
  - `append_ndjson` writes first metadata record then user payloads
  - `write_json` writes pretty JSON and `.json.meta`
  - `write_markdown` always prepends header
  - `ensure_dir` creates nested subdirectories
- Seeds recording (PB-1005/1006)
  - Multiple appends; newline-separated

## Example Cases (mapped to PBV-2xxx)
- PBV-2001: for_type creates correct path
- PBV-2002: env overrides honored
- PBV-2003: NDJSON append behavior
- PBV-2004: JSON pretty overwrite
- PBV-2005: Markdown overwrite with header
- PBV-2006: seeds recorder appends
- PBV-2009: Autogenerated header/metadata present

## Artifacts
- Integration tests use `tempfile::TempDir` and set `LLORCH_PROOF_DIR` to avoid polluting the workspace.

## Commands
- `cargo test -p proof-bundle --test conformance -- --nocapture`

## Links
- Spec: `/.specs/00_proof-bundle.md`
- Contracts: `/.specs/10_contracts.md`
- Types guide: `/.docs/testing/TEST_TYPES_GUIDE.md`
