# Proof-Bundle — Testing Overview (30_TESTING)

Status: Draft
Owner: @llama-orch-maintainers
Date: 2025-09-26

## Purpose
Document the testing strategy for the `proof-bundle` crate, aligned with central repo testing types. The crate is a filesystem utility with no network or orchestrator coupling; thus, relevant suites are Unit, Integration, and Contract (crate contract). BDD/E2E/Determinism/Smoke are not applicable at this library scope.

## Suites

- Unit (31_UNIT)
  - Target pure logic and small IO helpers without touching the broader filesystem (e.g., run-id resolution, directory mapping, name handling).
- Integration (33_INTEGRATION)
  - Exercise end-to-end writers with temporary directories and environment overrides.
  - Validate header enforcement and artifact shapes.
- Contract (34_CONTRACT)
  - Treat the crate’s public API and path/format semantics as a contract (see `/.specs/10_contracts.md` and `/.specs/00_proof-bundle.md`).

## Mapping to Spec IDs

Key normative requirements from `/.specs/00_proof-bundle.md`:
- PB-1001..PB-1012

Verification plan (tests live under `libs/proof-bundle/tests/`):
- PBV-2001: for_type creates `<type>/<run_id>/` at base
- PBV-2002: honors LLORCH_PROOF_DIR + LLORCH_RUN_ID
- PBV-2003: NDJSON append behavior (newline-terminated)
- PBV-2004: JSON pretty overwrite
- PBV-2005: Markdown overwrite
- PBV-2006: seeds recorder appends
- PBV-2007: TestType mapping
- PBV-2008: No panics on normal flows
- PBV-2009: Autogenerated headers/metadata present

## Commands

- Unit/Integration/Contract (conformance):
  - `cargo test -p proof-bundle -- --nocapture`

## Proof Bundles Emitted by Tests

- The crate’s tests use `LLORCH_PROOF_DIR` set to temporary directories, not the repo root, to avoid polluting workspaces.
- Artifacts written by consumers MUST include headers automatically (crate enforces this); crate tests verify the behavior.

## Not Applicable at Crate Scope

- BDD: covered at `test-harness/bdd/` for orchestrator flows.
- Determinism & E2E Haiku: engine-level suites; not relevant to filesystem helpers.
- Smoke: reference workstation acceptance; not applicable.
