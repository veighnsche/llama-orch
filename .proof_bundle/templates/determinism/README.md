# Determinism Suite Proof Bundle Template

Required generated artifacts

- pairs/ — side-by-side token stream outputs for identical inputs across replicas
- diffs/ — computed diffs highlighting mismatches (byte/token level)
- run_config.json — engine_version, sampler_profile_version, model_digest, seeds
- timing.csv — (optional) latency per token for reference
- test_report.md — summary, counts of matching/mismatching pairs

Notes

- See `/.specs/00_llama-orch.md` §5 (Determinism suite requirement).
- Enforce REQUIRE_REAL_LLAMA if applicable.

Path layout

- <crate>/.proof_bundle/determinism/<run_id>/
- run_id should be `YYYYMMDD-HHMMSS-<git_sha8>` or set `LLORCH_RUN_ID`.

Environment

- REQUIRE_REAL_LLAMA=1 — required to assert real-engine behavior
- LLORCH_RUN_ID — optional, groups artifacts per run
- LLORCH_PROOF_DIR — optional, overrides base bundle dir (defaults to `<crate>/.proof_bundle`)

Formats

- Streams and pairs: NDJSON for token streams, JSON for `run_config.json`
- Diffs: text or JSON highlighting mismatches with indices

Autogenerated header (required)

- Markdown/plain-text: first line MUST be `# AUTOGENERATED: Proof Bundle`.
- NDJSON: first record SHOULD be `{ "_meta": "proof_bundle", "_note": "autogenerated" }`.
- JSON: prefer sibling `<name>.meta` file with the header line; embedding `{ "generated_by": "proof-bundle" }` is acceptable.

Guidance

- Fix all seeds and sampler parameters; record them in `run_config.json` and `seeds.txt` if used.
- Name pair files consistently, e.g., `pairs/<case_id>__replicaA.ndjson` and `pairs/<case_id>__replicaB.ndjson`.
- Place computed diffs under `diffs/<case_id>.json` with fields `{"mismatch": bool, "first_diff_at": idx, ...}`.

Links

- See `.docs/testing/types/determinism.md` and `.docs/testing/TEST_TYPES_GUIDE.md`.
